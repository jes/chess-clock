<!doctype html>
<html>
<head>
<title>Chess Clock</title>
<link rel="stylesheet" type="text/css" href="css/chessboard-0.3.0.min.css">
<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
</head>
<body>
<div class="container">
<h1>Chess Clock</h1>
<span style="font-size:1.2em; font-weight:bold" id="hms"></span>
<div id="board" style="width:500px"></div>
(next move in <span id="nextmove"></span> <span id="seconds"></span>)
</div>

<script src="js/jquery-3.4.0.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/chessboard-0.3.0.min.js"></script>
<script src="js/fens.js"></script>
<script type="text/javascript">
    let board = ChessBoard('board', 'start');
    function redraw(use_anim) {
        let now = new Date();
        let hour = now.getHours();
        let min = now.getMinutes();
        let sec = now.getSeconds();
        let secsinday = hour*3600 + min*60 + sec;
        let boardposition = Math.floor(secsinday/10) % clock_fens.length;
        board.position(clock_fens[boardposition], use_anim);

        $('#hms').text(pad(hour,2) + ":" + pad(min,2) + ":" + Math.floor(sec/10) + "0");
        let secondsleft = 10 - (sec%10);
        $('#nextmove').text(secondsleft);
        $('#seconds').text("second" + (secondsleft == 1 ? '' : 's'));
    }
    redraw(false);
    window.setInterval(function() { redraw(true) }, 1000);

    // https://stackoverflow.com/a/10073788
    function pad(n, width, z) {
      z = z || '0';
      n = n + '';
      return n.length >= width ? n : new Array(width - n.length + 1).join(z) + n;
    }
</script>
</body>
</html>
